import{n as b,G as g,ax as A,V as ne,ak as H,al as oe,K as S,aC as ae,p as K,y as p,e as E,g as D,C as U,b as r,aD as G,f as B,aq as se,q as _,az as F,aA as V,i as q,m as I,j as le,M as ce,ab as Y,a9 as ie,ay as re,aE as ue,aF as de,a3 as fe,aG as ve,av as me,E as N,H as ye,I as Z,P as he,ac as ke,N as Ce,aH as we,af as Oe,ao as ge,aI as Ie,aB as be}from"./index.3fe0e41c.js";import{u as Se,a as W}from"./index.87fb0a01.js";import{L as Pe}from"./index.f08351aa.js";const xe={show:Boolean,zIndex:b,overlay:g,duration:b,teleport:[String,Object],lockScroll:g,lazyRender:g,beforeClose:Function,overlayStyle:Object,overlayClass:A,transitionAppear:Boolean,closeOnClickOverlay:g};let P=0;const M="van-overflow-hidden";function pe(e,t){const n=Se(),c="01",o="10",i=f=>{n.move(f);const l=n.deltaY.value>0?o:c,d=ae(f.target,e.value),{scrollHeight:y,offsetHeight:C,scrollTop:w}=d;let k="11";w===0?k=C>=y?"00":"01":w+C>=y&&(k="10"),k!=="11"&&n.isVertical()&&!(parseInt(k,2)&parseInt(l,2))&&K(f,!0)},a=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",i,{passive:!1}),P||document.body.classList.add(M),P++},u=()=>{P&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",i),P--,P||document.body.classList.remove(M))},m=()=>t()&&a(),v=()=>t()&&u();ne(m),H(v),oe(v),S(t,f=>{f?a():u()})}function J(e){const t=p(!1);return S(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const[Be,Te]=E("overlay"),ze={show:Boolean,zIndex:b,duration:b,className:A,lockScroll:g,lazyRender:g,customStyle:Object};var Ae=D({name:Be,props:ze,setup(e,{slots:t}){const n=p(),c=J(()=>e.show||!e.lazyRender),o=a=>{e.lockScroll&&K(a,!0)},i=c(()=>{var a;const u=B(se(e.zIndex),e.customStyle);return _(e.duration)&&(u.animationDuration=`${e.duration}s`),F(r("div",{ref:n,style:u,class:[Te(),e.className]},[(a=t.default)==null?void 0:a.call(t)]),[[V,e.show]])});return U("touchmove",o,{target:n}),()=>r(G,{name:"van-fade",appear:!0},{default:i})}});const Le=q(Ae),Ee=B({},xe,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[De,$]=E("popup");var _e=D({name:De,inheritAttrs:!1,props:Ee,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:c}){let o,i;const a=p(),u=p(),m=J(()=>e.show||!e.lazyRender),v=le(()=>{const s={zIndex:a.value};if(_(e.duration)){const h=e.position==="center"?"animationDuration":"transitionDuration";s[h]=`${e.duration}s`}return s}),f=()=>{o||(o=!0,a.value=e.zIndex!==void 0?+e.zIndex:ve(),t("open"))},l=()=>{o&&me(e.beforeClose,{done(){o=!1,t("close"),t("update:show",!1)}})},d=s=>{t("clickOverlay",s),e.closeOnClickOverlay&&l()},y=()=>{if(e.overlay)return r(Le,{show:e.show,class:e.overlayClass,zIndex:a.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:d},{default:c["overlay-content"]})},C=s=>{t("clickCloseIcon",s),l()},w=()=>{if(e.closeable)return r(Z,{role:"button",tabindex:0,name:e.closeIcon,class:[$("close-icon",e.closeIconPosition),ye],classPrefix:e.iconPrefix,onClick:C},null)},k=()=>t("opened"),Q=()=>t("closed"),X=s=>t("keydown",s),ee=m(()=>{var s;const{round:h,position:T,safeAreaInsetTop:L,safeAreaInsetBottom:te}=e;return F(r("div",N({ref:u,style:v.value,role:"dialog",tabindex:0,class:[$({round:h,[T]:T}),{"van-safe-area-top":L,"van-safe-area-bottom":te}],onKeydown:X},n),[(s=c.default)==null?void 0:s.call(c),w()]),[[V,e.show]])}),R=()=>{const{position:s,transition:h,transitionAppear:T}=e,L=s==="center"?"van-fade":`van-popup-slide-${s}`;return r(G,{name:h||L,appear:T,onAfterEnter:k,onAfterLeave:Q},{default:ee})};return S(()=>e.show,s=>{s&&!o&&(f(),n.tabindex===0&&ce(()=>{var h;(h=u.value)==null||h.focus()})),!s&&o&&(o=!1,t("close"))}),W({popupRef:u}),pe(u,()=>e.show&&e.lockScroll),U("popstate",()=>{e.closeOnPopstate&&(l(),i=!1)}),Y(()=>{e.show&&f()}),ie(()=>{i&&(t("update:show",!0),i=!1)}),H(()=>{e.show&&e.teleport&&(l(),i=!0)}),re(ue,()=>e.show),()=>e.teleport?r(de,{to:e.teleport},{default:()=>[y(),R()]}):r(fe,null,[y(),R()])}});const Ne=q(_e);let x=0;function Re(e){e?(x||document.body.classList.add("van-toast--unclickable"),x++):x&&(x--,x||document.body.classList.remove("van-toast--unclickable"))}const[Me,O]=E("toast"),$e=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],je={icon:String,show:Boolean,type:I("text"),overlay:Boolean,message:b,iconSize:b,duration:he(2e3),position:I("middle"),teleport:[String,Object],wordBreak:String,className:A,iconPrefix:String,transition:I("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:A,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var He=D({name:Me,props:je,emits:["update:show"],setup(e,{emit:t,slots:n}){let c,o=!1;const i=()=>{const l=e.show&&e.forbidClick;o!==l&&(o=l,Re(o))},a=l=>t("update:show",l),u=()=>{e.closeOnClick&&a(!1)},m=()=>clearTimeout(c),v=()=>{const{icon:l,type:d,iconSize:y,iconPrefix:C,loadingType:w}=e;if(l||d==="success"||d==="fail")return r(Z,{name:l||d,size:y,class:O("icon"),classPrefix:C},null);if(d==="loading")return r(Pe,{class:O("loading"),size:y,type:w},null)},f=()=>{const{type:l,message:d}=e;if(n.message)return r("div",{class:O("text")},[n.message()]);if(_(d)&&d!=="")return l==="html"?r("div",{key:0,class:O("text"),innerHTML:String(d)},null):r("div",{class:O("text")},[d])};return S(()=>[e.show,e.forbidClick],i),S(()=>[e.show,e.type,e.message,e.duration],()=>{m(),e.show&&e.duration>0&&(c=setTimeout(()=>{a(!1)},e.duration))}),Y(i),ke(i),()=>r(Ne,N({class:[O([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:u,onClosed:m,"onUpdate:show":a},Ce(e,$e)),{default:()=>[v(),f()]})}});function Ke(){const e=Oe({show:!1}),t=o=>{e.show=o},n=o=>{B(e,o,{transitionAppear:!0}),t(!0)},c=()=>t(!1);return W({open:n,close:c,toggle:t}),{open:n,close:c,state:e,toggle:t}}function Ue(e){const t=we(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}const Ge={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let z=[],Fe=!1,j=B({},Ge);const Ve=new Map;function qe(e){return Ie(e)?e:{message:e}}function Ye(){const{instance:e,unmount:t}=Ue({setup(){const n=p(""),{open:c,state:o,close:i,toggle:a}=Ke(),u=()=>{},m=()=>r(He,N(o,{onClosed:u,"onUpdate:show":a}),null);return S(n,v=>{o.message=v}),be().render=m,{open:c,close:i,message:n}}});return e}function Ze(){if(!z.length||Fe){const e=Ye();z.push(e)}return z[z.length-1]}function Xe(e={}){if(!ge)return{};const t=Ze(),n=qe(e);return t.open(B({},j,Ve.get(n.type||j.type),n)),t}export{Ne as P,He as a,Xe as s};
