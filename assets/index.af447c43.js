import{e as K,m as S,n as T,G as te,ax as O,f as F,r as xe,g as H,h as Ve,b as o,q as P,I as A,i as U,aM as we,at as Ee,aI as Le,aN as Te,aO as Pe,F as Re,af as Me,y as D,z as _e,aP as Be,j as _,l as Ae,ay as $e,K as Ne,M as N,ab as Oe,C as De,aQ as X,aR as Fe,p as j,aS as ze,E as ne,d as qe,aT as We,N as Z}from"./index.3fe0e41c.js";import{u as ae}from"./use-id.b8830f5a.js";import{a as le}from"./index.87fb0a01.js";const[je,L]=K("cell"),re={tag:S("div"),icon:String,size:String,title:T,value:T,label:T,center:Boolean,isLink:Boolean,border:te,required:Boolean,iconPrefix:String,valueClass:O,labelClass:O,titleClass:O,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Ke=F({},re,xe);var He=H({name:je,props:Ke,setup(e,{slots:n}){const a=Ve(),d=()=>{if(n.label||P(e.label))return o("div",{class:[L("label"),e.labelClass]},[n.label?n.label():e.label])},i=()=>{if(n.title||P(e.title))return o("div",{class:[L("title"),e.titleClass],style:e.titleStyle},[n.title?n.title():o("span",null,[e.title]),d()])},u=()=>{const s=n.value||n.default;if(s||P(e.value))return o("div",{class:[L("value"),e.valueClass]},[s?s():o("span",null,[e.value])])},x=()=>{if(n.icon)return n.icon();if(e.icon)return o(A,{name:e.icon,class:L("left-icon"),classPrefix:e.iconPrefix},null)},C=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const s=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(A,{name:s,class:L("right-icon")},null)}};return()=>{var s;const{tag:h,size:f,center:R,border:V,isLink:M,required:v}=e,y=(s=e.clickable)!=null?s:M,k={center:R,required:v,clickable:y,borderless:!V};return f&&(k[f]=!!f),o(h,{class:L(k),role:y?"button":void 0,tabindex:y?0:void 0,onClick:a},{default:()=>{var I;return[x(),i(),u(),C(),(I=n.extra)==null?void 0:I.call(n)]}})}}});const Ue=U(He);function ie(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Ye(e,n){if(ie(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Ge(e,n){return new Promise(a=>{const d=n.validator(e,n);if(Te(d)){d.then(a);return}a(d)})}function p(e,n){const{message:a}=n;return Pe(a)?a(e,n):a||""}function Je({target:e}){e.composing=!0}function ee({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Qe(e,n){const a=we();e.style.height="auto";let d=e.scrollHeight;if(Le(n)){const{maxHeight:i,minHeight:u}=n;i!==void 0&&(d=Math.min(d,i)),u!==void 0&&(d=Math.max(d,u))}d&&(e.style.height=`${d}px`,Ee(a))}function Xe(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function W(e){return[...e].length}function Ze(e,n){return[...e].slice(0,n).join("")}const[pe,m]=K("field"),Y={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:T,formatter:Function,clearIcon:S("clear"),modelValue:Re(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:S("focus"),formatTrigger:S("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},et=F({},re,Y,{rows:T,type:S("text"),rules:Array,autosize:[Boolean,Object],labelWidth:T,labelClass:O,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var tt=H({name:pe,props:et,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const d=ae(),i=Me({status:"unvalidated",focused:!1,validateMessage:""}),u=D(),x=D(),C=D(),{parent:s}=_e(Be),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},f=t=>{if(P(e[t]))return e[t];if(s&&P(s.props[t]))return s.props[t]},R=_(()=>{const t=f("readonly");if(e.clearable&&!t){const r=h()!=="",c=e.clearTrigger==="always"||e.clearTrigger==="focus"&&i.focused;return r&&c}return!1}),V=_(()=>C.value&&a.input?C.value():e.modelValue),M=t=>t.reduce((r,c)=>r.then(()=>{if(i.status==="failed")return;let{value:g}=V;if(c.formatter&&(g=c.formatter(g,c)),!Ye(g,c)){i.status="failed",i.validateMessage=p(g,c);return}if(c.validator)return ie(g)&&c.validateEmpty===!1?void 0:Ge(g,c).then(b=>{b&&typeof b=="string"?(i.status="failed",i.validateMessage=b):b===!1&&(i.status="failed",i.validateMessage=p(g,c))})}),Promise.resolve()),v=()=>{i.status="unvalidated",i.validateMessage=""},y=()=>n("endValidate",{status:i.status,message:i.validateMessage}),k=(t=e.rules)=>new Promise(r=>{v(),t?(n("startValidate"),M(t).then(()=>{i.status==="failed"?(r({name:e.name,message:i.validateMessage}),y()):(i.status="passed",r(),y())})):r()}),I=t=>{if(s&&e.rules){const{validateTrigger:r}=s.props,c=X(r).includes(t),g=e.rules.filter(b=>b.trigger?X(b.trigger).includes(t):c);g.length&&k(g)}},z=t=>{const{maxlength:r}=e;if(P(r)&&W(t)>r){const c=h();return c&&W(c)===+r?c:Ze(t,+r)}return t},w=(t,r="onChange")=>{const c=t;t=z(t);const g=t!==c;if(e.type==="number"||e.type==="digit"){const b=e.type==="number";t=Fe(t,b,b)}if(e.formatter&&r===e.formatTrigger&&(t=e.formatter(t)),u.value&&u.value.value!==t)if(i.focused&&g){const{selectionStart:b,selectionEnd:Se}=u.value;u.value.value=t,u.value.setSelectionRange(b-1,Se-1)}else u.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},q=t=>{t.target.composing||w(t.target.value)},l=()=>{var t;return(t=u.value)==null?void 0:t.blur()},$=()=>{var t;return(t=u.value)==null?void 0:t.focus()},E=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&Qe(t,e.autosize)},oe=t=>{i.focused=!0,n("focus",t),N(E),f("readonly")&&l()},ce=t=>{f("readonly")||(i.focused=!1,w(h(),"onBlur"),n("blur",t),I("onBlur"),N(E),We())},G=t=>n("clickInput",t),se=t=>n("clickLeftIcon",t),ue=t=>n("clickRightIcon",t),de=t=>{j(t),n("update:modelValue",""),n("clear",t)},J=_(()=>{if(typeof e.error=="boolean")return e.error;if(s&&s.props.showError&&i.status==="failed")return!0}),fe=_(()=>{const t=f("labelWidth");if(t)return{width:Ae(t)}}),ge=t=>{t.keyCode===13&&(!(s&&s.props.submitOnEnter)&&e.type!=="textarea"&&j(t),e.type==="search"&&l()),n("keypress",t)},Q=()=>e.id||`${d}-input`,be=()=>i.status,me=()=>{const t=m("control",[f("inputAlign"),{error:J.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return o("div",{class:t,onClick:G},[a.input()]);const r={id:Q(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:f("disabled"),readonly:f("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${d}-label`:void 0,onBlur:ce,onFocus:oe,onInput:q,onClick:G,onChange:ee,onKeypress:ge,onCompositionend:ee,onCompositionstart:Je};return e.type==="textarea"?o("textarea",r,null):o("input",ne(Xe(e.type),r),null)},he=()=>{const t=a["left-icon"];if(e.leftIcon||t)return o("div",{class:m("left-icon"),onClick:se},[t?t():o(A,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},ve=()=>{const t=a["right-icon"];if(e.rightIcon||t)return o("div",{class:m("right-icon"),onClick:ue},[t?t():o(A,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},ye=()=>{if(e.showWordLimit&&e.maxlength){const t=W(h());return o("div",{class:m("word-limit")},[o("span",{class:m("word-num")},[t]),qe("/"),e.maxlength])}},Ie=()=>{if(s&&s.props.showErrorMessage===!1)return;const t=e.errorMessage||i.validateMessage;if(t){const r=a["error-message"],c=f("errorMessageAlign");return o("div",{class:m("error-message",c)},[r?r({message:t}):t])}},Ce=()=>{const t=f("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return o("label",{id:`${d}-label`,for:Q()},[e.label+t])},ke=()=>[o("div",{class:m("body")},[me(),R.value&&o(A,{ref:x,name:e.clearIcon,class:m("clear")},null),ve(),a.button&&o("div",{class:m("button")},[a.button()])]),ye(),Ie()];return le({blur:l,focus:$,validate:k,formValue:V,resetValidation:v,getValidationStatus:be}),$e(ze,{customValue:C,resetValidation:v,validateWithTrigger:I}),Ne(()=>e.modelValue,()=>{w(h()),v(),I("onChange"),N(E)}),Oe(()=>{w(h(),e.formatTrigger),N(E)}),De("touchstart",de,{target:_(()=>{var t;return(t=x.value)==null?void 0:t.$el})}),()=>{const t=f("disabled"),r=f("labelAlign"),c=Ce(),g=he(),b=()=>r==="top"?[g,c]:c;return o(Ue,{size:e.size,class:m({error:J.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:fe.value,valueClass:m("value"),titleClass:[m("label",[r,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:g&&r!=="top"?()=>g:null,title:c||r==="top"?b:null,value:ke,extra:a.extra})}}});const nt=U(tt),[at,B,lt]=K("search"),rt=F({},Y,{label:String,shape:S("square"),leftIcon:S("search"),clearable:te,actionText:String,background:String,showAction:Boolean});var it=H({name:at,props:rt,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:d}){const i=ae(),u=D(),x=()=>{a.action||(n("update:modelValue",""),n("cancel"))},C=l=>{l.keyCode===13&&(j(l),n("search",e.modelValue))},s=()=>e.id||`${i}-input`,h=()=>{if(a.label||e.label)return o("label",{class:B("label"),for:s()},[a.label?a.label():e.label])},f=()=>{if(e.showAction){const l=e.actionText||lt("cancel");return o("div",{class:B("action"),role:"button",tabindex:0,onClick:x},[a.action?a.action():l])}},R=()=>{var l;return(l=u.value)==null?void 0:l.blur()},V=()=>{var l;return(l=u.value)==null?void 0:l.focus()},M=l=>n("blur",l),v=l=>n("focus",l),y=l=>n("clear",l),k=l=>n("clickInput",l),I=l=>n("clickLeftIcon",l),z=l=>n("clickRightIcon",l),w=Object.keys(Y),q=()=>{const l=F({},d,Z(e,w),{id:s()}),$=E=>n("update:modelValue",E);return o(nt,ne({ref:u,type:"search",class:B("field"),border:!1,onBlur:M,onFocus:v,onClear:y,onKeypress:C,onClickInput:k,onClickLeftIcon:I,onClickRightIcon:z,"onUpdate:modelValue":$},l),Z(a,["left-icon","right-icon"]))};return le({focus:V,blur:R}),()=>{var l;return o("div",{class:B({"show-action":e.showAction}),style:{background:e.background}},[(l=a.left)==null?void 0:l.call(a),o("div",{class:B("content",e.shape)},[h(),q()]),f()])}}});const ut=U(it);export{Ue as C,ut as S};
