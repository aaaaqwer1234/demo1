import{e as q,g as K,y as I,ap as rt,D as lt,j as D,q as ut,C as H,ab as dt,K as X,b as m,aF as ht,G as ft,n as U,P as pt,am as vt,X as B,S as L,M as _t,at as mt,aM as Y,p as gt,af as xt,z as yt,f as kt,aq as Ct,aL as St,i as Z,_ as J,u as Q,o as v,c as C,w as W,a as E,a3 as w,a4 as $,t as Tt,a8 as V,a2 as z,a0 as bt,az as At,aA as wt}from"./index.3fe0e41c.js";import{a as It,T as Rt}from"./index.dd8ecdbc.js";import"./index.e1e60aae.js";import{C as $t,S as Dt}from"./index.af447c43.js";import{u as tt}from"./city.4eff1e1a.js";import{u as Ot,a as et}from"./index.87fb0a01.js";import"./use-id.b8830f5a.js";function Pt(){const t="A".charCodeAt(0);return Array(26).fill("").map((o,u)=>String.fromCharCode(t+u))}const[ot,P]=q("index-bar"),Bt={sticky:ft,zIndex:U,teleport:[String,Object],highlightColor:String,stickyOffsetTop:pt(0),indexList:{type:Array,default:Pt}},nt=Symbol(ot);var Lt=K({name:ot,props:Bt,emits:["select","change"],setup(t,{emit:g,slots:o}){const u=I(),r=I(),d=I(""),c=Ot(),h=rt(u),{children:n,linkChildren:x}=lt(nt);let a;x({props:t});const y=D(()=>{if(ut(t.zIndex))return{zIndex:+t.zIndex+1}}),f=D(()=>{if(t.highlightColor)return{color:t.highlightColor}}),_=(e,s)=>{for(let i=n.length-1;i>=0;i--){const p=i>0?s[i-1].height:0,l=t.sticky?p+t.stickyOffsetTop:0;if(e+l>=s[i].top)return i}return-1},b=e=>n.find(s=>String(s.index)===e),O=()=>{if(vt(u))return;const{sticky:e,indexList:s}=t,i=B(h.value),p=L(h),l=n.map(A=>A.getRect(h.value,p));let S=-1;if(a){const A=b(a);if(A){const T=A.getRect(h.value,p);S=_(T.top,l)}}else S=_(i,l);d.value=s[S],e&&n.forEach((A,T)=>{const{state:k,$el:it}=A;if(T===S||T===S-1){const R=it.getBoundingClientRect();k.left=R.left,k.width=R.width}else k.left=null,k.width=null;if(T===S)k.active=!0,k.top=Math.max(t.stickyOffsetTop,l[T].top-i)+p.top;else if(T===S-1&&a===""){const R=l[S].top-i;k.active=R>0,k.top=R+p.top-l[T].height}else k.active=!1}),a=""},M=()=>{_t(O)};H("scroll",O,{target:h,passive:!0}),dt(M),X(()=>t.indexList,M),X(d,e=>{e&&g("change",e)});const st=()=>t.indexList.map(e=>{const s=e===d.value;return m("span",{class:P("index",{active:s}),style:s?f.value:void 0,"data-index":e},[e])}),N=e=>{a=String(e);const s=b(a);if(s){const i=B(h.value),p=L(h),{offsetHeight:l}=document.documentElement;if(s.$el.scrollIntoView(),i===l-p.height){O();return}t.sticky&&t.stickyOffsetTop&&mt(Y()-t.stickyOffsetTop),g("select",s.index)}},j=e=>{const{index:s}=e.dataset;s&&N(s)},ct=e=>{j(e.target)};let F;const at=e=>{if(c.move(e),c.isVertical()){gt(e);const{clientX:s,clientY:i}=e.touches[0],p=document.elementFromPoint(s,i);if(p){const{index:l}=p.dataset;l&&F!==l&&(F=l,j(p))}}},G=()=>m("div",{ref:r,class:P("sidebar"),style:y.value,onClick:ct,onTouchstartPassive:c.start},[st()]);return et({scrollTo:N}),H("touchmove",at,{target:r}),()=>{var e;return m("div",{ref:u,class:P()},[t.teleport?m(ht,{to:t.teleport},{default:()=>[G()]}):G(),(e=o.default)==null?void 0:e.call(o)])}}});const[Et,Vt]=q("index-anchor"),zt={index:U};var Mt=K({name:Et,props:zt,setup(t,{slots:g}){const o=xt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),u=I(),{parent:r}=yt(nt);if(!r)return;const d=()=>o.active&&r.props.sticky,c=D(()=>{const{zIndex:n,highlightColor:x}=r.props;if(d())return kt(Ct(n),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:x})});return et({state:o,getRect:(n,x)=>{const a=L(u);return o.rect.height=a.height,n===window||n===document.body?o.rect.top=a.top+Y():o.rect.top=a.top+B(n)-x.top,o.rect}}),()=>{const n=d();return m("div",{ref:u,style:{height:n?`${o.rect.height}px`:void 0}},[m("div",{style:c.value,class:[Vt({sticky:n}),{[St]:n}]},[g.default?g.default():t.index])])}}});const Nt=Z(Mt),jt=Z(Lt);const Ft={class:"city-group"},Gt={class:"list"},Ht=["onClick"],Xt={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(t){const g=t,o=D(()=>{const c=g.groupData.cities.map(h=>h.group);return c.unshift("#"),c}),u=Q(),r=tt(),d=c=>{r.currentCity=c,u.back()};return(c,h)=>{const n=Nt,x=$t,a=jt;return v(),C("div",Ft,[m(a,{sticky:!1,"index-list":z(o)},{default:W(()=>[m(n,{index:"\u70ED\u95E8"}),E("div",Gt,[(v(!0),C(w,null,$(t.groupData.hotCities,(y,f)=>(v(),C("div",{class:"city",onClick:_=>d(y)},Tt(y.cityName),9,Ht))),256))]),(v(!0),C(w,null,$(t.groupData.cities,(y,f)=>(v(),C(w,{key:f},[m(n,{index:y.group},null,8,["index"]),(v(!0),C(w,null,$(y.cities,(_,b)=>(v(),V(x,{key:b,title:_.cityName,onClick:O=>d(_)},null,8,["title","onClick"]))),128))],64))),128))]),_:1},8,["index-list"])])}}},qt=J(Xt,[["__scopeId","data-v-911a3acc"]]);const Kt={class:"city top-page"},Ut={class:"top"},Yt={class:"content"},Zt={__name:"city",setup(t){const g=Q(),o=I(""),u=()=>{g.back()},r=I(),d=tt();d.fetchAllCityData();const{allCities:c}=bt(d);return D(()=>c.value[r.value]),(h,n)=>{const x=Dt,a=It,y=Rt;return v(),C("div",Kt,[E("div",Ut,[m(x,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=f=>o.value=f),placeholder:"\u57CE\u5E02/\u533A\u57DF/\u4F4D\u7F6E",shape:"round","show-action":"",onCancel:u},null,8,["modelValue"]),m(y,{active:r.value,"onUpdate:active":n[1]||(n[1]=f=>r.value=f),color:"#ff9854","line-height":"3"},{default:W(()=>[(v(!0),C(w,null,$(z(c),(f,_,b)=>(v(),V(a,{key:_,title:f.title,name:_},null,8,["title","name"]))),128))]),_:1},8,["active"])]),E("div",Yt,[(v(!0),C(w,null,$(z(c),(f,_,b)=>At((v(),V(qt,{"group-data":f},null,8,["group-data"])),[[wt,r.value===_]])),256))])])}}},se=J(Zt,[["__scopeId","data-v-188df7aa"]]);export{se as default};
